# PB-BI 开发计划

## 版本信息
- 版本: 3.7
- 创建日期: 2026-02-14
- 最后更新: 2026-02-22
- 状态: UI/UX优化完成

## 迭代规划

### 迭代 1: 项目初始化与基础框架
**目标**: 搭建项目基础架构，完成配置管理模块

**时间**: 2 周

**任务清单**:
- [x] 创建项目目录结构
- [x] 配置后端 Python 环境
- [x] 配置前端 React 环境
- [x] 实现配置管理数据库
- [x] 实现明道云 API 配置接口
- [x] 实现数据流管理接口（增删改查）
- [x] 实现连接测试接口
- [x] 前端配置页面开发
- [x] 代码审查
- [ ] 测试

### 迭代 1.1: 字段配置功能
**目标**: 实现字段配置功能，包括字段启用设置和字段类型设置

**时间**: 1 天

**任务清单**:
- [x] 更新数据库模型，添加 is_enabled 字段
- [x] 实现获取字段列表接口
- [x] 实现保存字段配置接口
- [x] 前端添加设置按钮
- [x] 前端字段配置界面开发
- [x] 代码审查
- [x] 测试
- [x] 功能修复

### 迭代 1.2: 数据同步和展示
**目标**: 实现将明道云的数据按数据设置读入并展示在数据页面

**时间**: 1 天

**任务清单**:
- [x] 更新数据API，支持仅读取启用的字段
- [x] 实现数据查询接口
- [x] 前端数据页面开发（数据流选择）
- [x] 前端数据表格展示
- [ ] 实现分页功能
- [x] 代码审查
- [x] 测试

---

### 迭代 2.0: 混合架构（FastAPI + Spring Boot 桥接）
**目标**: 采用 HTTP API 桥接方案，FastAPI 作为网关，Spring Boot 提供 Calcite + SeaTunnel 服务

**时间**: 4 周

**阶段 1: Spring Boot 数据服务搭建（第 1 周）**
- [ ] 创建 Spring Boot 项目基础框架
- [ ] 配置 Maven 依赖（Spring Boot、Calcite、SeaTunnel）
- [ ] 实现 Calcite 基础集成
- [ ] 实现 SeaTunnel 基础集成
- [ ] Spring Boot 服务基础测试

**阶段 2: FastAPI 桥接层开发（第 2 周）**
- [ ] 创建 FastAPI 内部桥接 API 模块
- [ ] 实现 Spring Boot API 客户端
- [ ] 实现 Calcite 查询桥接接口
- [ ] 实现 SeaTunnel 同步桥接接口
- [ ] 桥接层单元测试

**阶段 3: Calcite 高级功能集成（第 3 周）**
- [ ] 实现 Calcite 自定义 Schema（明道云数据源）
- [ ] 实现 Calcite 自定义 Schema（快照数据源）
- [ ] 实现 SQL 查询优化
- [ ] 集成测试

**阶段 4: SeaTunnel 数据同步集成（第 4 周）**
- [ ] 配置 SeaTunnel 作业（明道云 → 本地数据库）
- [ ] 实现增量同步功能
- [ ] 实现同步任务调度
- [ ] 端到端集成测试
- [ ] 代码审查
- [ ] 性能测试

---

### 迭代 2.2: 数据可视化模块增强
**目标**: 取消DataV图表库，新增4个ECharts图表（3D柱状图、堆叠折线图、堆叠柱状图、多Y轴图）

**时间**: 1 天

**任务清单**:
- [x] 取消DataV图表库
- [x] 安装echarts-gl（3D图表支持）
- [x] 创建3D柱状图组件 - bar3d-simplex-noise
- [x] 创建堆叠折线图组件 - line-stack
- [x] 创建堆叠柱状图组件 - bar-stack-borderRadius
- [x] 创建多Y轴图组件 - multiple-y-axis
- [x] 更新VisualPage，移除DataV并添加新ECharts图表
- [x] 更新ChartSettings支持新图表
- [x] 更新需求分析文档
- [x] 更新架构设计文档
- [x] 代码审查
- [ ] 测试

### 迭代 2.3: 导入本地数据功能
**目标**: 支持从本地导入CSV和Excel格式的数据文件

**时间**: 1 天

**任务清单**:
- [x] 安装pandas和openpyxl依赖
- [x] 后端实现导入CSV和Excel功能API
- [x] 前端添加导入本地数据按钮
- [x] 前端添加文件选择和数据预览界面
- [x] 重构导入流程：先创建本地数据流，再导入文件
- [x] 代码审查
- [x] 测试

---

### 迭代 2.4: 字段筛选和数据统计功能
**目标**: 增强数据分析功能，添加字段筛选和数据统计

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档
- [x] 架构师更新架构设计文档
- [x] 项目经理更新开发计划文档
- [x] 前端分析页面添加"字段筛选"标签页
- [x] 实现字段选择和预览功能
- [x] 支持保存筛选结果为新快照
- [x] 前端分析页面添加"数据统计"标签页
- [x] 实现数值字段自动识别和统计
- [x] 统计指标：计数、求和、平均值、最小值、最大值
- [x] 支持保存统计结果为新快照
- [x] 代码审查
- [ ] 测试

### 迭代 2.5: 操作介绍页面
**目标**: 增加操作介绍页，展示软件布局和操作指导

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档
- [x] 架构师更新架构设计文档
- [x] 项目经理更新开发计划文档
- [x] 前端添加操作介绍页面
- [x] 页面包含软件整体布局说明
- [x] 展示各个页面的功能介绍
- [x] 提供详细的操作指导
- [x] 支持快速跳转到各个功能页面
- [x] 界面美观，易于阅读
- [ ] 代码审查
- [ ] 测试

### 迭代 2.6: 高级统计分析功能
**目标**: 使用 statsmodels 和 scikit-learn 实现高级统计分析功能

**时间**: 3 天

**任务清单**:
- [x] 架构师更新需求分析文档（v1.9→v2.0）
- [x] 架构师更新架构设计文档（v2.6→v2.7）
- [x] 项目经理更新开发计划文档（v2.5→v2.6）
- [x] 安装 statsmodels 和 scikit-learn 依赖
- [x] 后端实现统计描述分析 API
- [x] 后端实现分布拟合分析 API
- [x] 后端实现回归分析 API
- [x] 前端分析页面添加"高级统计"标签页
- [x] 实现统计描述分析界面
- [x] 实现分布拟合分析界面
- [x] 实现回归分析界面
- [x] 实现结果可视化展示
- [x] 支持保存分析结果为新快照
- [x] 代码审查
- [x] 测试
- [x] 修复字段类型设置不生效问题

### 迭代 2.7: 分布拟合图表
**目标**: 为分布拟合分析结果添加拟合分布图（直方图+拟合曲线）

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.0→v2.1）
- [x] 架构师更新架构设计文档（v2.7→v2.8）
- [x] 项目经理更新开发计划文档（v2.6→v2.7）
- [x] 后端API修改：返回直方图和拟合曲线数据
- [x] 前端组件修改：显示拟合分布图（ECharts）
- [x] 代码审查
- [x] 测试

### 迭代 2.8: 高级统计分析功能完善
**目标**: 完善高级统计分析功能，包括分布拟合空数据处理、回归拟合公式和图表、多项式回归degree设置

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.1→v2.2）
- [x] 架构师更新架构设计文档（v2.8→v2.9）
- [x] 项目经理更新开发计划文档（v2.7→v2.8）
- [x] 分布拟合：添加"数据设置"区域和"去掉空数据"选项（默认勾选）
- [x] 分布拟合：修复直方图和拟合曲线区间不一致问题
- [x] 回归分析：添加拟合公式显示（所有系数保留4位小数）
- [x] 回归分析：添加回归拟合图（蓝色散点表示实际数据，红色曲线表示拟合结果）
- [x] 多项式回归：添加degree设置输入框（1-10，默认2）
- [x] 后端修改：所有回归类型的公式生成都使用.4f格式化
- [x] 代码审查
- [x] 测试

### 迭代 2.9: 新增MSE、相关分析、蒙特卡洛分析
**目标**: 回归模型评估增加均方误差（MSE），新增相关分析和蒙特卡洛分析功能

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.2→v2.3）
- [x] 架构师更新架构设计文档（v2.9→v3.0）
- [x] 项目经理更新开发计划文档（v2.8→v2.9）
- [x] 开发人员：后端回归分析API添加MSE计算
- [x] 开发人员：后端实现相关分析API（相关系数矩阵、热力图数据）
- [x] 开发人员：后端实现蒙特卡洛分析API（随机模拟、统计结果）
- [x] 开发人员：前端高级统计添加"相关分析"类型
- [x] 开发人员：前端高级统计添加"蒙特卡洛分析"类型
- [x] 开发人员：前端展示相关系数矩阵和热力图
- [x] 开发人员：前端展示蒙特卡洛分析结果和图表
- [x] 代码审查
- [x] 测试
- [x] ACP专家总结经验教训

### 迭代 2.10: 相关性分析独立成页
**目标**: 相关性分析从高级统计中移出，作为独立页面，支持多数据流字段分析

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.3→v2.4）
- [x] 架构师更新架构设计文档（v3.0→v3.1）
- [x] 项目经理更新开发计划文档（v2.9→v3.0）
- [x] 开发人员：后端API修改，支持多数据流字段相关分析
- [x] 开发人员：后端支持3种相关系数类型（皮尔逊、斯皮尔曼、肯德尔）
- [x] 开发人员：后端实现高相关对识别功能
- [x] 开发人员：前端创建独立的相关性分析页面 CorrelationPage.jsx
- [x] 开发人员：前端导航栏添加"相关性"入口
- [x] 开发人员：从AdvancedStats中移除"相关分析"标签页
- [x] 开发人员：实现多快照选择功能
- [x] 开发人员：实现字段选择功能（每个快照可选多个字段）
- [x] 开发人员：实现相关系数类型选择
- [x] 开发人员：前端展示相关系数矩阵表格
- [x] 开发人员：前端展示相关系数热力图
- [x] 开发人员：前端展示高相关对列表
- [x] 代码审查
- [x] 测试

### 迭代 2.11: 相关性探索功能
**目标**: 相关性分析添加筛选高相关字段功能，新增相关性探索标签页

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.4→v2.5）
- [x] 架构师更新架构设计文档（v3.1→v3.2）
- [x] 项目经理更新开发计划文档（v3.0→v3.1）
- [x] 开发人员：后端API修改，支持相关性阈值设置
- [x] 开发人员：后端新增correlation-explore API端点
- [x] 开发人员：后端实现两两字段组合分析
- [x] 开发人员：后端实现高相关对筛选（按阈值）
- [x] 开发人员：后端实现结果按相关系数排序
- [x] 开发人员：前端CorrelationPage添加标签页切换（相关性分析/相关性探索）
- [x] 开发人员：前端添加相关性阈值设置（默认0.7/0.8）
- [x] 开发人员：前端实现相关性分析高相关字段筛选
- [x] 开发人员：前端实现相关性探索功能
- [x] 开发人员：前端展示高相关对列表（按相关系数排序）
- [x] 代码审查
- [x] 测试
- [x] ACP专家总结经验教训

### 迭代 2.12: 蒙特卡洛分析独立成页
**目标**: 蒙特卡洛分析从高级统计中移出，作为独立页面，支持经典案例和自定义模拟

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.5→v2.6）
- [x] 架构师更新架构设计文档（v3.2→v3.3）
- [x] 项目经理更新开发计划文档（v3.1→v3.2）
- [x] 开发人员：后端API添加经典蒙特卡洛案例（圆周率、定积分、排队问题）
- [x] 开发人员：后端API新增/montecarlo/pi端点
- [x] 开发人员：后端API新增/montecarlo/integral端点
- [x] 开发人员：后端API新增/montecarlo/queue端点
- [x] 开发人员：前端创建MonteCarloPage.jsx独立页面
- [x] 开发人员：前端导航栏添加"蒙特卡洛"入口
- [x] 开发人员：从AdvancedStats中移除"蒙特卡洛分析"标签页
- [x] 开发人员：前端实现经典案例（圆周率、定积分、排队问题）
- [ ] 开发人员：前端实现自定义模拟功能
- [x] 开发人员：前端展示可视化图表（散点图、直方图等）
- [x] 代码审查
- [x] 测试

### 迭代 2.13: 图表功能优化与第一阶段总结
**目标**: 优化现有图表功能，完成第一阶段开发，总结经验教训

**时间**: 1 天

**任务清单**:
- [x] 架构师更新需求分析文档（v2.6→v2.7）
- [x] 架构师更新架构设计文档（v3.3→v3.4）
- [x] 项目经理更新开发计划文档（v3.2→v3.3）
- [x] 开发人员：3D柱状图优化（透明效果、数据维度修复）
- [x] 开发人员：3D形貌图创建（Surface3DChart）
- [x] 开发人员：联动图表创建（LinkedChart）
- [x] 开发人员：LED晶圆分析图创建（LEDWaferChart）
- [x] 开发人员：波长到RGB颜色转换算法实现
- [x] 开发人员：数据看板图表高度加大（翻倍）
- [x] 代码审查
- [x] 测试
- [x] ACP专家总结经验教训
- [x] 第一阶段完成总结

### 迭代 3.0: 可部署版本生成
**目标**: 生成可以部署的版本，用于测试在其他电脑上部署和从其他电脑访问

**时间**: 1 天

**任务清单**:
- [x] 架构师确认部署需求
- [x] 项目经理制定部署计划
- [x] 开发人员：后端部署配置（host=0.0.0.0）
- [x] 开发人员：前端构建优化
- [x] 开发人员：创建启动脚本
- [x] 开发人员：创建部署说明文档
- [x] 开发人员：测试本地部署
- [x] 开发人员：测试局域网访问
- [x] 代码审查
- [x] 测试

### 迭代 3.1: 便携版优化与配置系统
**目标**: 优化便携版配置系统，支持灵活配置路径和端口，无需pip/npm安装依赖

**时间**: 1 天

**任务清单**:
- [x] 开发人员：创建配置文件示例（config.example.ini）
- [x] 开发人员：创建配置读取脚本（load-config.bat）
- [x] 开发人员：修改后端启动脚本支持配置系统
- [x] 开发人员：修改前端启动脚本支持配置系统
- [x] 开发人员：修改前端API地址为动态获取
- [x] 开发人员：创建更新便携版前端脚本（update-portable.bat）
- [x] 开发人员：更新README.md便携版说明
- [x] 开发人员：GitHub仓库更新
- [x] 开发人员：局域网测试验证
- [x] 代码审查
- [x] 测试

### 迭代 3.2: 用户认证模块
**目标**: 实现用户登录、注册、权限控制，内置admin角色查看所有数据

**时间**: 1 天

**任务清单**:
- [x] 架构师：更新需求分析文档（v2.8→v2.9）
- [x] 架构师：更新架构设计文档（v3.5→v3.6）
- [x] 项目经理：更新开发计划文档（v3.5→v3.6）
- [x] 开发人员：后端安装bcrypt和itsdangerous依赖
- [x] 开发人员：后端创建用户模型（user.py）
- [x] 开发人员：后端创建安全工具（security.py）
- [x] 开发人员：后端创建权限检查（permissions.py）
- [x] 开发人员：后端创建认证服务（auth.py）
- [x] 开发人员：后端创建认证API（api/auth.py）
- [x] 开发人员：后端数据库模型更新（添加user_id外键）
- [x] 开发人员：后端更新现有API添加权限控制
- [x] 开发人员：后端系统初始化时创建admin用户
- [x] 开发人员：前端创建认证服务（auth.js）
- [x] 开发人员：前端创建认证上下文（AuthContext.jsx）
- [x] 开发人员：前端创建登录页面（LoginPage.jsx）
- [x] 开发人员：前端创建登录表单（LoginForm.jsx）
- [x] 开发人员：前端创建注册表单（RegisterForm.jsx）
- [x] 开发人员：前端添加路由保护
- [x] 开发人员：前端导航栏添加用户信息和登出
- [x] 代码审查
- [x] 测试
- [x] ACP专家：总结经验教训

### 迭代 3.3: UI/UX优化
**目标**: 优化页面设计，采用简约专业的商业数据分析风格

**时间**: 1 天

**任务清单**:
- [x] UI/UX设计师：设计商业数据分析配色方案
- [x] UI/UX设计师：优化登录页面设计
- [x] UI/UX设计师：优化导航栏样式
- [x] UI/UX设计师：优化按钮和表单样式
- [x] UI/UX设计师：优化页面容器样式
- [x] 测试

---

### 迭代 3: 数据运算模块
**目标**: 实现数据运算功能，包括可视化运算和自定义 Java 代码

**时间**: 2 周

**任务清单**:
- [ ] 实现可视化运算逻辑
- [ ] 实现 JVM 沙箱环境
- [ ] 实现自定义 Java 代码执行接口
- [ ] 前端计算器组件开发
- [ ] 前端代码编辑器组件开发
- [ ] 代码审查
- [ ] 测试

---

### 迭代 4: 数据可视化模块完善
**目标**: 完善图表设置和优化用户体验

**时间**: 1 周

**任务清单**:
- [ ] 图表设置完善
- [ ] 图表设置优化
- [ ] 代码审查
- [ ] 测试

---

### 迭代 5: 集成与优化
**目标**: 整体集成、优化和文档完善

**时间**: 1 周

**任务清单**:
- [ ] 端到端集成测试
- [ ] 性能优化
- [ ] 用户体验优化
- [ ] 完善文档
- [ ] 最终验收测试

---

## 人员分配

| 角色 | 职责 |
|------|------|
| 架构师 | 架构设计、需求确认 |
| 项目经理 | 计划制定、进度跟踪 |
| 开发人员 | 前端、后端开发 |
| 代码审查人员 | 代码审查 |
| 测试人员 | 测试用例、测试执行 |
| ACP 专家 | 经验总结 |

## 进度跟踪

### 当前状态
- 迭代 2.12: 已完成（蒙特卡洛分析独立成页）
- 迭代 2.13: 已完成（图表功能优化与第一阶段总结）
- 迭代 3.0: 已完成（可部署版本生成）
- 迭代 3.1: 已完成（便携版优化与配置系统）
- 迭代 3.2: 已完成（用户认证模块）
- 迭代 3.3: 已完成（UI/UX优化）

### 里程碑
- [x] 迭代 1 完成
- [x] 迭代 1.1 完成
- [x] 迭代 1.2 完成
- [ ] 迭代 2.0 阶段 1 完成（Spring Boot 数据服务）
- [ ] 迭代 2.0 阶段 2 完成（FastAPI 桥接层）
- [ ] 迭代 2.0 阶段 3 完成（Calcite 集成）
- [ ] 迭代 2.0 阶段 4 完成（SeaTunnel 集成）
- [ ] 迭代 2.0 完成（混合架构）
- [x] 迭代 2.2 完成（数据可视化模块增强）
- [x] 迭代 2.3 完成（导入本地数据功能）
- [x] 迭代 2.4 完成（字段筛选和数据统计功能）
- [x] 迭代 2.5 完成（操作介绍页面）
- [x] 迭代 2.6 完成（高级统计分析功能）
- [x] 迭代 2.7 完成（分布拟合图表）
- [x] 迭代 2.8 完成（高级统计分析功能完善）
- [x] 迭代 2.9 完成（新增MSE、相关分析、蒙特卡洛分析）
- [x] 迭代 2.10 完成（相关性分析独立成页）
- [x] 迭代 2.11 完成（相关性探索功能）
- [x] 迭代 2.12 完成（蒙特卡洛分析独立成页）
- [x] 迭代 2.13 完成（图表功能优化与第一阶段总结）
- [x] 迭代 3.0 完成（可部署版本生成）
- [x] 迭代 3.1 完成（便携版优化与配置系统）
- [x] 迭代 3.2 完成（用户认证模块）
- [x] 迭代 3.3 完成（UI/UX优化）
- [ ] 迭代 3 完成
- [ ] 迭代 4 完成
- [ ] 迭代 5 完成
- [ ] 项目交付

---

## 第一阶段总结

### 已完成功能
1. ✅ 配置管理模块
2. ✅ 数据获取模块
3. ✅ 数据分析模块
4. ✅ 数据可视化模块
5. ✅ 操作介绍模块

### 待完善功能
1. ⚠️ 蒙特卡洛分析模块：自定义模拟功能待开发
2. ⚠️ 可视化计算模块：尚未开展

### 下一步计划
- 迭代 3.0：生成可部署版本
- 测试在其他电脑上部署
- 测试局域网访问

---

**变更记录**
| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|----------|
| 1.0 | 2026-02-14 | 项目经理 | 初始版本创建 |
| 1.1 | 2026-02-14 | 项目经理 | 更新迭代 1 进度，添加迭代 1.1 字段配置功能 |
| 1.2 | 2026-02-15 | 项目经理 | 标记迭代 1.1 完成，添加迭代 1.2 数据同步和展示 |
| 2.0 | 2026-02-15 | 项目经理 | 添加迭代 2.0 架构重构计划（Spring Boot + Calcite + SeaTunnel） |
| 2.1 | 2026-02-15 | 项目经理 | 更新迭代 2.0 为混合架构方案（FastAPI + Spring Boot 桥接） |
| 2.2 | 2026-02-19 | 项目经理 | 添加迭代 2.2 数据可视化模块增强计划（取消DataV，新增4个ECharts图表） |
| 2.3 | 2026-02-19 | 项目经理 | 添加迭代 2.3 导入本地数据功能计划（CSV和Excel），标记完成 |
| 2.4 | 2026-02-19 | 项目经理 | 添加迭代 2.4 字段筛选和数据统计功能计划 |
| 2.5 | 2026-02-19 | 项目经理 | 添加迭代 2.5 操作介绍页面计划 |
| 2.6 | 2026-02-20 | 项目经理 | 添加迭代 2.6 高级统计分析功能计划 |
| 2.7 | 2026-02-20 | 项目经理 | 添加迭代 2.7 分布拟合图表计划 |
| 2.8 | 2026-02-20 | 项目经理 | 添加迭代 2.8 高级统计分析功能完善计划 |
| 2.9 | 2026-02-21 | 项目经理 | 添加迭代 2.9 新增MSE、相关分析、蒙特卡洛分析计划，标记完成 |
| 3.0 | 2026-02-21 | 项目经理 | 添加迭代 2.10 相关性分析独立成页计划 |
| 3.1 | 2026-02-21 | 项目经理 | 添加迭代 2.11 相关性探索功能计划，标记完成 |
| 3.2 | 2026-02-21 | 项目经理 | 添加迭代 2.12 蒙特卡洛分析独立成页计划，标记完成 |
| 3.3 | 2026-02-22 | 项目经理 | 添加迭代 2.13 图表功能优化与第一阶段总结，添加迭代 3.0 可部署版本生成计划 |
| 3.4 | 2026-02-22 | 项目经理 | 迭代 3.0 可部署版本生成完成 |
| 3.5 | 2026-02-23 | 项目经理 | 添加迭代 3.1 便携版优化与配置系统，标记完成 |
| 3.6 | 2026-02-23 | 项目经理 | 添加迭代 3.2 用户认证模块计划（登录/注册/权限控制） |
